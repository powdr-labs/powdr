use std::machines::hash::keccakf16::Keccakf16;

machine Main with degree: 64 {
    reg pc[@pc];

    reg X0[<=];
    reg X1[<=];
    reg X2[<=];
    reg X3[<=];
    reg X4[<=];
    reg X5[<=];
    reg X6[<=];
    reg X7[<=];
    reg X8[<=];
    reg X9[<=];
    reg X10[<=];
    reg X11[<=];
    reg X12[<=];
    reg X13[<=];
    reg X14[<=];
    reg X15[<=];
    reg X16[<=];
    reg X17[<=];
    reg X18[<=];
    reg X19[<=];
    reg X20[<=];
    reg X21[<=];
    reg X22[<=];
    reg X23[<=];
    reg X24[<=];
    reg X25[<=];
    reg X26[<=];
    reg X27[<=];
    reg X28[<=];
    reg X29[<=];
    reg X30[<=];
    reg X31[<=];
    reg X32[<=];
    reg X33[<=];
    reg X34[<=];
    reg X35[<=];
    reg X36[<=];
    reg X37[<=];
    reg X38[<=];
    reg X39[<=];
    reg X40[<=];
    reg X41[<=];
    reg X42[<=];
    reg X43[<=];
    reg X44[<=];
    reg X45[<=];
    reg X46[<=];
    reg X47[<=];
    reg X48[<=];
    reg X49[<=];
    reg X50[<=];
    reg X51[<=];
    reg X52[<=];
    reg X53[<=];
    reg X54[<=];
    reg X55[<=];
    reg X56[<=];
    reg X57[<=];
    reg X58[<=];
    reg X59[<=];
    reg X60[<=];
    reg X61[<=];
    reg X62[<=];
    reg X63[<=];
    reg X64[<=];
    reg X65[<=];
    reg X66[<=];
    reg X67[<=];
    reg X68[<=];
    reg X69[<=];
    reg X70[<=];
    reg X71[<=];
    reg X72[<=];
    reg X73[<=];
    reg X74[<=];
    reg X75[<=];
    reg X76[<=];
    reg X77[<=];
    reg X78[<=];
    reg X79[<=];
    reg X80[<=];
    reg X81[<=];
    reg X82[<=];
    reg X83[<=];
    reg X84[<=];
    reg X85[<=];
    reg X86[<=];
    reg X87[<=];
    reg X88[<=];
    reg X89[<=];
    reg X90[<=];
    reg X91[<=];
    reg X92[<=];
    reg X93[<=];
    reg X94[<=];
    reg X95[<=];
    reg X96[<=];
    reg X97[<=];
    reg X98[<=];
    reg X99[<=];

    reg Y0[<=];
    reg Y1[<=];
    reg Y2[<=];
    reg Y3[<=];
    reg Y4[<=];
    reg Y5[<=];
    reg Y6[<=];
    reg Y7[<=];
    reg Y8[<=];
    reg Y9[<=];
    reg Y10[<=];
    reg Y11[<=];
    reg Y12[<=];
    reg Y13[<=];
    reg Y14[<=];
    reg Y15[<=];
    reg Y16[<=];
    reg Y17[<=];
    reg Y18[<=];
    reg Y19[<=];
    reg Y20[<=];
    reg Y21[<=];
    reg Y22[<=];
    reg Y23[<=];
    reg Y24[<=];
    reg Y25[<=];
    reg Y26[<=];
    reg Y27[<=];
    reg Y28[<=];
    reg Y29[<=];
    reg Y30[<=];
    reg Y31[<=];
    reg Y32[<=];
    reg Y33[<=];
    reg Y34[<=];
    reg Y35[<=];
    reg Y36[<=];
    reg Y37[<=];
    reg Y38[<=];
    reg Y39[<=];
    reg Y40[<=];
    reg Y41[<=];
    reg Y42[<=];
    reg Y43[<=];
    reg Y44[<=];
    reg Y45[<=];
    reg Y46[<=];
    reg Y47[<=];
    reg Y48[<=];
    reg Y49[<=];
    reg Y50[<=];
    reg Y51[<=];
    reg Y52[<=];
    reg Y53[<=];
    reg Y54[<=];
    reg Y55[<=];
    reg Y56[<=];
    reg Y57[<=];
    reg Y58[<=];
    reg Y59[<=];
    reg Y60[<=];
    reg Y61[<=];
    reg Y62[<=];
    reg Y63[<=];
    reg Y64[<=];
    reg Y65[<=];
    reg Y66[<=];
    reg Y67[<=];
    reg Y68[<=];
    reg Y69[<=];
    reg Y70[<=];
    reg Y71[<=];
    reg Y72[<=];
    reg Y73[<=];
    reg Y74[<=];
    reg Y75[<=];
    reg Y76[<=];
    reg Y77[<=];
    reg Y78[<=];
    reg Y79[<=];
    reg Y80[<=];
    reg Y81[<=];
    reg Y82[<=];
    reg Y83[<=];
    reg Y84[<=];
    reg Y85[<=];
    reg Y86[<=];
    reg Y87[<=];
    reg Y88[<=];
    reg Y89[<=];
    reg Y90[<=];
    reg Y91[<=];
    reg Y92[<=];
    reg Y93[<=];
    reg Y94[<=];
    reg Y95[<=];
    reg Y96[<=];
    reg Y97[<=];
    reg Y98[<=];
    reg Y99[<=];

    reg A0;
    reg A1;
    reg A2;
    reg A3;
    reg A4;
    reg A5;
    reg A6;
    reg A7;
    reg A8;
    reg A9;
    reg A10;
    reg A11;
    reg A12;
    reg A13;
    reg A14;
    reg A15;
    reg A16;
    reg A17;
    reg A18;
    reg A19;
    reg A20;
    reg A21;
    reg A22;
    reg A23;
    reg A24;
    reg A25;
    reg A26;
    reg A27;
    reg A28;
    reg A29;
    reg A30;
    reg A31;
    reg A32;
    reg A33;
    reg A34;
    reg A35;
    reg A36;
    reg A37;
    reg A38;
    reg A39;
    reg A40;
    reg A41;
    reg A42;
    reg A43;
    reg A44;
    reg A45;
    reg A46;
    reg A47;
    reg A48;
    reg A49;
    reg A50;
    reg A51;
    reg A52;
    reg A53;
    reg A54;
    reg A55;
    reg A56;
    reg A57;
    reg A58;
    reg A59;
    reg A60;
    reg A61;
    reg A62;
    reg A63;
    reg A64;
    reg A65;
    reg A66;
    reg A67;
    reg A68;
    reg A69;
    reg A70;
    reg A71;
    reg A72;
    reg A73;
    reg A74;
    reg A75;
    reg A76;
    reg A77;
    reg A78;
    reg A79;
    reg A80;
    reg A81;
    reg A82;
    reg A83;
    reg A84;
    reg A85;
    reg A86;
    reg A87;
    reg A88;
    reg A89;
    reg A90;
    reg A91;
    reg A92;
    reg A93;
    reg A94;
    reg A95;
    reg A96;
    reg A97;
    reg A98;
    reg A99;

    Keccakf16 keccakf16;

    instr keccakf16 X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X17, X18, X19, X20, X21, X22, X23, X24, X25, X26, X27, X28, X29, X30, X31, X32, X33, X34, X35, X36, X37, X38, X39, X40, X41, X42, X43, X44, X45, X46, X47, X48, X49, X50, X51, X52, X53, X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, X68, X69, X70, X71, X72, X73, X74, X75, X76, X77, X78, X79, X80, X81, X82, X83, X84, X85, X86, X87, X88, X89, X90, X91, X92, X93, X94, X95, X96, X97, X98, X99 -> Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, Y8, Y9, Y10, Y11, Y12, Y13, Y14, Y15, Y16, Y17, Y18, Y19, Y20, Y21, Y22, Y23, Y24, Y25, Y26, Y27, Y28, Y29, Y30, Y31, Y32, Y33, Y34, Y35, Y36, Y37, Y38, Y39, Y40, Y41, Y42, Y43, Y44, Y45, Y46, Y47, Y48, Y49, Y50, Y51, Y52, Y53, Y54, Y55, Y56, Y57, Y58, Y59, Y60, Y61, Y62, Y63, Y64, Y65, Y66, Y67, Y68, Y69, Y70, Y71, Y72, Y73, Y74, Y75, Y76, Y77, Y78, Y79, Y80, Y81, Y82, Y83, Y84, Y85, Y86, Y87, Y88, Y89, Y90, Y91, Y92, Y93, Y94, Y95, Y96, Y97, Y98, Y99 link => (Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, Y8, Y9, Y10, Y11, Y12, Y13, Y14, Y15, Y16, Y17, Y18, Y19, Y20, Y21, Y22, Y23, Y24, Y25, Y26, Y27, Y28, Y29, Y30, Y31, Y32, Y33, Y34, Y35, Y36, Y37, Y38, Y39, Y40, Y41, Y42, Y43, Y44, Y45, Y46, Y47, Y48, Y49, Y50, Y51, Y52, Y53, Y54, Y55, Y56, Y57, Y58, Y59, Y60, Y61, Y62, Y63, Y64, Y65, Y66, Y67, Y68, Y69, Y70, Y71, Y72, Y73, Y74, Y75, Y76, Y77, Y78, Y79, Y80, Y81, Y82, Y83, Y84, Y85, Y86, Y87, Y88, Y89, Y90, Y91, Y92, Y93, Y94, Y95, Y96, Y97, Y98, Y99) = keccakf16.keccakf16(X0, X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X17, X18, X19, X20, X21, X22, X23, X24, X25, X26, X27, X28, X29, X30, X31, X32, X33, X34, X35, X36, X37, X38, X39, X40, X41, X42, X43, X44, X45, X46, X47, X48, X49, X50, X51, X52, X53, X54, X55, X56, X57, X58, X59, X60, X61, X62, X63, X64, X65, X66, X67, X68, X69, X70, X71, X72, X73, X74, X75, X76, X77, X78, X79, X80, X81, X82, X83, X84, X85, X86, X87, X88, X89, X90, X91, X92, X93, X94, X95, X96, X97, X98, X99);

    instr assert_eq X0, X1 {
        X0 = X1
    }

    function main {
        // 0 for all 25 64-bit inputs except setting the second 64-bit input to 1. All 64-bit inputs in chunks of 4 16-bit little endian limbs.
        A0, A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21, A22, A23, A24, A25, A26, A27, A28, A29, A30, A31, A32, A33, A34, A35, A36, A37, A38, A39, A40, A41, A42, A43, A44, A45, A46, A47, A48, A49, A50, A51, A52, A53, A54, A55, A56, A57, A58, A59, A60, A61, A62, A63, A64, A65, A66, A67, A68, A69, A70, A71, A72, A73, A74, A75, A76, A77, A78, A79, A80, A81, A82, A83, A84, A85, A86, A87, A88, A89, A90, A91, A92, A93, A94, A95, A96, A97, A98, A99 <== keccakf16(0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
        // Selectively checking a few registers only.
        assert_eq A0, 0x405f;
        assert_eq A3, 0xfdbb;
        assert_eq A92, 0x8f6e;
        assert_eq A95, 0x3e10;
        assert_eq A96, 0xeb35;
        assert_eq A99, 0xeac9;

        return;
    }
}
